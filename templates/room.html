<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<head>
<title>HotPot prototype! yeah!!</title>

<!-- Typekit JS -->
<!--<script type="text/javascript" src="http://use.typekit.com/qje5yme.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>-->

<!-- jQuery library -->
<script src="http://code.jquery.com/jquery-1.6.4.min.js" type="text/javascript"></script>

<!-- OpenTok JS -->
<!--script src="http://staging.tokbox.com/v0.91/js/TB.min.js" type="text/javascript"></script-->
<!--script src="/static/js/opentok.js" type="text/javascript"></script-->

<!-- Socket IO -->
<script src="/static/js/lib/socket.io.min.js" type="text/javascript"></script>

<!-- my scripts -->
<script src="/static/js/room.js" type="text/javascript"></script>

<link rel="stylesheet" href="/static/css/core.css" type="text/css" />

</head>
 
<body id="room" data-id="{{ invitationId }}">

<header id="cookingHeader">
	<h1>Hotpot</h1>
	Logged in as <span id="userId">{{ userId }}</span>
</header>

<div id="container">
	
	<div id="recipeContainer">
		
		<section id="recipe" data-id="{{ meal._id }}">
		
			<h1 id="recipeTitle">{{ meal.title }}</h1>
			
			<nav id="recipeNav">
				<ul id="stepTabs">
				{% set stepCounter = 1 %}
				{% for step in meal.steps %}
					<li class="{{ step.type }} {% if loop.first %}currentStep{% endif %}">
						{% if step.type == "prep" or step.type == "heat" or step.type == "finish" %}
							{% set stepNumber = stepCounter %}
							{% set stepCounter = stepCounter + 1 %}
						{% else %}
							{% set stepNumber = step.type %}
						{% endif %}
						<a href="" id="stepTab-{{ step.id }}">{{ stepNumber }}</a>
					</li>
				{% endfor %}
				</ul>
				
				<div id="stepsNav">
					<a href="#" id="startButton">Start</a>
					<a href="#" id="prevButton">Previous</a>
					<a href="#" id="nextButton">Next</a>
				</div>
			</nav><!-- #recipeNav -->
			
			<section id="steps">
				<ol>
					{% for step in meal.steps %}
					<li id="step-{{ step.id }}" class="step {{ step.type }}" {% if loop.first %}style="display:block;"{% endif %}>
						{{ step.text|safe }}
						
						{% if step.type == "ingredients" %}
						<ul>
						{% for ingredient in meal.ingredients %}
							<li>{{ ingredient.name }} {% if ingredient.amount is defined %}({{ ingredient.amount }}){% endif %}</li>
						{% endfor %}
						</ul>
						{% endif %}
						
						{% if step.extra is defined %}
						<div class="extra">
							<h1>Protip!</h1>
							{{ step.extra|safe }}
						</div>
						{% endif %}
						
						<!-- Cooking Notes! wheeeee -->
						<div class="notesContainer">
						{% if step.notes is defined %}
							{% for note in step.notes %}
							<div class="cookingNote {{ note.type }}" data-id="{{ note._id }}"><img src="/static/uploads/userpics/{{ note.noteAuthor.userpic }}" class="userpic" />			
								<div class="timestamp">{{ note.timestamp }}</div>
								
								<div class="noteContent">
									{% if note.type == "note" %}
										<p>{{ note.content }}</p>
									{% elif note.type == "stamp" %}
										<img src="/static/images/stamps/{{ note.content.stampSlug }}.png" />
										<p>{{ note.content.stampName }}</p>
									{% endif %}
								</div>
							</div>
							{% endfor %}
						{% endif %}
						</div><!-- .notesContainer -->
						
						<!--
						{% if step.snippets is defined %}
							{% for snippet in step.snippets %}
							<section class="snippet {{ snippet.type }}" data-id="{{ snippet._id }}">
							
								<h1>{{ snippet.type|capitalize }}</h1>
								{{ snippet.text|safe }}
								
								{% if snippet.type == "foodnote" %}
									<form class="foodnoteForm">
										<textarea name="note" class="note"></textarea>
										<input type="submit" />
									</form>
									
									{% if snippet.notes is defined %}
										{% for note in snippet.notes %}
										<div class="usernote" data-id"' + data.noteId + '">
											{{ note.text }}
											<div class="postedBy">Posted by {{ note.name }}</div>
										</div>
										{% endfor %}
									{% endif %}
									
								{% endif %}
							</section>
							{% endfor %}
							
						{% endif %}
						-->
						
					</li>
					{% endfor %}				
				</ol>
						
				<div id="widgets">
					<nav id="widgetNav">
						<a href="" id="stampPickerButton" class="widgetButton">Stamps</a>
						<a href="" id="notepadButton" class="widgetButton">Cooking Notes</a>
					</nav>
					
					<div id="stampPicker" class="widget">
						<a href="" class="closeButton">Close</a>
						
						<div id="stampInfoDisplay" style="display:none;">
						</div>
						
						<div id="stampInstructions">
							<p>Click on a stamp to add it to the cooking timeline.</p>
						</div>
						
						<ul>
						{% for stamp in stamps %}
							<li class="stamp">
								<a href="" id="{{ stamp.slug }}" class="stampButton"><img src="/static/images/stamps/{{ stamp.slug }}.png" width="40" /></a>
								<div class="stampInfo">
									<h3>{{ stamp.name }}</h3>
									<p class="description">{{ stamp.description }}</p>
								</div>
							</li>
						{% endfor %}
						</ul>
						
					</div><!-- #stampPicker -->
					
					<div id="notepad" class="widget">
						<a href="" class="closeButton">Close</a>
						<p>Use this space to jot down impressions, surprises, questions and answers.</p>
						<form id="noteForm">
							<textarea name="note" class="note"></textarea>
							<input type="submit" />
						</form>
					</div><!-- #notepad -->
				
				</div><!-- #widgets -->
				
			</section><!-- #steps -->
			
		</section><!-- #recipe -->
		
	</div><!-- #recipeContainer -->

	<div id="videoContainer">
		<a href="#" id="chatBoxButton">Toggle Chat Box</a>
		<div id="videos">
			<!-- OpenTok adds video elements here -->
		</div>
		<div id="partnerStatus"></div>
		<div id="myStatus"></div>
	</div>
	
	<div id="myInfo">
		<div id="myVideo">
			<!-- OpenTok adds video elements here -->
		</div>
	</div>
	
	<div id="chatBoxContainer">
		<div id="chatBox">
			<div id="chatMessages">
				<!-- CHAT MESSAGES APPEAR HERE -->
			</div><!-- #messages -->			
				
			<div id="chatInputContainer">
				<form id="chatInputForm">
					<input type="text" name="chatMessage" />
				</form>
			</div>
			
		</div><!-- #chatBox -->
		
	</div><!-- #chatContainer -->

</div><!-- #container -->
</body>
</html>